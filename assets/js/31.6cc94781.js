(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{539:function(a,t,e){"use strict";e.r(t);var l=e(6),r=Object(l.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("p",[e("img",{attrs:{src:"http://share.alihanniba.com/mac/2021-05-15-041202.jpg",alt:"http://share.alihanniba.com/mac/2021-05-15-041202.jpg"}})]),a._v(" "),e("ul",[e("li",[a._v("题图：pixabay")])]),a._v(" "),e("p",[a._v("强一致性、去中心化、高可用的分布式协议。（貌似不是强一致性，应该是最终一致性）")]),a._v(" "),e("p",[a._v("共识算法。")]),a._v(" "),e("p",[a._v("何谓共识算法：就是多个节点对某个事情达成一致的看法，即使是在部分节点故障、网络延时、网络分割的情况下。")]),a._v(" "),e("p",[a._v("节点有3个状态：")]),a._v(" "),e("ul",[e("li",[a._v("leader")]),a._v(" "),e("li",[a._v("follower")]),a._v(" "),e("li",[a._v("candidate")])]),a._v(" "),e("p",[a._v("状态转变逻辑：")]),a._v(" "),e("p",[e("img",{attrs:{src:"http://share.alihanniba.com/mac/2021-05-15-041307.jpg",alt:"http://share.alihanniba.com/mac/2021-05-15-041307.jpg"}})]),a._v(" "),e("p",[a._v("关键点：")]),a._v(" "),e("ul",[e("li",[a._v("follower状态节点如果发现leader一段时间没给自己发心跳包，就会变成candidate发起选举。\n"),e("ul",[e("li",[a._v("可能是leader节点挂了")]),a._v(" "),e("li",[a._v("可能是网络原因")]),a._v(" "),e("li",[a._v("可能是其他原因")])])]),a._v(" "),e("li",[a._v("总之就是收不到心跳选举只能由 candidate 状态的节点发起")]),a._v(" "),e("li",[a._v("打个比方。有A,B,C三个节点。一开始都是follower状态。这时候是没有Leader的。一段时间后，全部变成 candidate。然后发起投票，可能是投自己，也有可能投别人。谁的票数最高。谁变成Leader。其他的变成 follower。例如：A变成Leader，然后会给B,C发心跳告诉他们我是Leader。B,C则自动变成 follower。\n"),e("ul",[e("li",[a._v("投给谁。这个是怎么决定的？")]),a._v(" "),e("li",[a._v("log replicate机制")])])]),a._v(" "),e("li",[a._v("可参考美国民主选举一样群众有投票权的选民总统平票的处理节点设定为基数个randomized election timeouts（？？？不知道啥玩意儿）")])]),a._v(" "),e("p",[a._v("raft几大概念")]),a._v(" "),e("ul",[e("li",[a._v("选举")]),a._v(" "),e("li",[a._v("任期")]),a._v(" "),e("li",[a._v("日志拷贝")]),a._v(" "),e("li",[a._v("数据同步")])]),a._v(" "),e("p",[a._v("选举：")]),a._v(" "),e("p",[a._v("就是发起投票")]),a._v(" "),e("p",[a._v("raft理解神器："),e("a",{attrs:{href:"http://thesecretlivesofdata.com/raft/",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://thesecretlivesofdata.com/raft/"),e("OutboundLink")],1)]),a._v(" "),e("p",[a._v("参考："),e("a",{attrs:{href:"https://www.cnblogs.com/xybaby/p/10124083.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.cnblogs.com/xybaby/p/10124083.html"),e("OutboundLink")],1)]),a._v(" "),e("h3",{attrs:{id:""}},[e("a",{staticClass:"header-anchor",attrs:{href:"#"}},[a._v("#")])]),a._v(" "),e("img",{staticClass:"wechat-num",attrs:{src:"http://share.alihanniba.com/mac/490lq.png"}})])}),[],!1,null,null,null);t.default=r.exports}}]);